package otm

type OTM struct {
	Version         string              `json:"otmVersion" yaml:"otmVersion"` // Required
	Project         OTMProject          `json:"project" yaml:"project"`       // Required
	Representations []OTMRepresentation `json:"representations" yaml:"representations"`
}

type OTMProject struct {
	Name         string            `json:"name" yaml:"name"` // Required
	Id           string            `json:"id" yaml:"id"`     // Required
	Description  string            `json:"description" yaml:"description"`
	Owner        string            `json:"owner" yaml:"owner"`
	OwnerContact string            `json:"ownerContact" yaml:"ownerContact"`
	Tags         []string          `json:"tags" yaml:"tags"`
	Attributes   map[string]string `json:"attributes" yaml:"attributes"`
}

type OTMRepresentation struct {
	Name string `json:"name" yaml:"name"` // Required
	Id   string `json:"id" yaml:"id"`     // Required

	Type string `json:"Type" yaml:"type"` // Required
	// Can be diagram, code, or threat-model

	Description string            `json:"description" yaml:"description"`
	Attributes  map[string]string `json:"attributes" yaml:"attributes"`

	// When Type is diagram, you must set the Size
	Size OTMSize `json:"size" yaml:"size"` // Required

	// When type is code, you may set the Repository
	Repository OTMRepository `json:"repository" yaml:"repository"`
}

type OTMRepository struct {
	Url string `json:"url" yaml:"url"`
}

type OTMSize struct {
	Width  int `json:"width" yaml:"width"`   // Required
	Height int `json:"height" yaml:"height"` // Required
}

type OTMPosition struct {
	X int `json:"x" yaml:"x"` // Required
	Y int `json:"y" yaml:"y"` // Required
}

type OTMAsset struct {
	Name        string            `json:"name" yaml:"name"` // Required
	Id          string            `json:"id" yaml:"id"`     // Required
	Description string            `json:"description" yaml:"description"`
	Risk        OTMAssetRisk      `json:"risk" yaml:"risk"` // Required
	Attributes  map[string]string `json:"attributes" yaml:"attributes"`
}

type OTMAssetRisk struct {
	Confidentiality int    `json:"confidentiality" yaml:"confidentiality"`
	Integrity       int    `json:"integrity" yaml:"integrity"`
	Availability    int    `json:"availability" yaml:"availability"`
	Comment         string `json:"comment" yaml:"comment"`
}

type OTMComponent struct {
}

type OTMDataFlow struct {
}

type OTMTrustZone struct {
}

type OTMThreat struct {
}

type OTMMitigation struct {
}
